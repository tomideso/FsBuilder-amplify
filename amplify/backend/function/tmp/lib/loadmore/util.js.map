{"version":3,"sources":["loadmore/util.ts"],"names":["FsLibrary","prototype","getNextData","url","Promise","resolve","xhr","XMLHttpRequest","open","send","onload","status","response","then","res","appendPaginatedData","data","newDoc","Date","now","collection","querySelectorAll","cms_selector","index","nextHref","parentElement","querySelector","setLoadmoreHref","href","appendToCms","children","hidden_collections","length","getLoadmoreHref","outerHTML","master_collection","getMasterCollection","append","slice","call","map","element","classList","add","type","remove","appendChild","addClass","addclasses","addClassConfig","nestConfig","nest","all","hrefButton","setAttribute","selector","getHiddenCollections","document","filter","e","setHiddenCollections","val","cloneNode"],"mappings":"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","file":"util.js","sourcesContent":["import { FsLibrary } from \"../fsLibrary\";\nimport { whichAnimationEvent, createDocument, isVisible } from \"../utility\";\nimport { once } from \"../../js/util/index\";\n\n\n\nFsLibrary.prototype.getNextData = function (url) {\n  return new Promise((resolve) => {\n    let xhr = new XMLHttpRequest();\n    xhr.open(\"GET\", url);\n    xhr.send();\n    xhr.onload = () => {\n      if (xhr.status == 200) {\n        // done(xhr.response);\n        return resolve(xhr.response);\n      }\n    };\n  }).then((res) => res);\n};\n\nFsLibrary.prototype.appendPaginatedData = function (data: string) {\n  const newDoc = createDocument(data, \"newDoc\" + Date.now());\n  const collection = newDoc.querySelectorAll(this.cms_selector)[this.index];\n  const nextHref = collection.parentElement.querySelector(\".w-pagination-next\");\n  nextHref\n    ? this.setLoadmoreHref((<any>nextHref).href)\n    : this.setLoadmoreHref(\"\");\n  collection && this.appendToCms(collection.children);\n\n  if (!this.hidden_collections.length && !nextHref) {\n    (<any>this.getLoadmoreHref()).outerHTML = \"\";\n  }\n};\n\nFsLibrary.prototype.appendToCms = function (collection) {\n  const master_collection = this.getMasterCollection();\n\n  const append=[].slice.call(collection).map((element) => {\n    element.classList.add(\"fslib-fadeIn\");\n\n    once(element, whichAnimationEvent(), ({ type }) => {\n      element.classList.remove(\"fslib-fadeIn\");\n    });\n\n    master_collection.appendChild(element);\n    if (this.addClass) {\n      this.addclasses(this.addClassConfig);\n    }\n    return Promise.resolve();\n  });\n\n  if (this.nestConfig) {\n    this.nest(this.nestConfig);\n  }\n\n  return Promise.all(append);\n};\n\nFsLibrary.prototype.setLoadmoreHref = function (url) {\n  const master_collection = this.getMasterCollection();\n  const hrefButton = master_collection.parentElement.querySelector(\n    \"a.w-pagination-next\"\n  );\n  hrefButton.setAttribute(\"data-href\", url || (<any>hrefButton).href);\n  return hrefButton;\n};\n\nFsLibrary.prototype.getLoadmoreHref = function (selector?) {\n  const master_collection = this.getMasterCollection();\n  const hrefButton = master_collection.parentElement.querySelector(\n    selector || \"a.w-pagination-next\"\n  );\n  return hrefButton;\n};\n\nFsLibrary.prototype.getHiddenCollections = function (): any[] {\n  return [].slice\n    .call(document.querySelectorAll(this.cms_selector))\n    .filter((e) => !isVisible(e));\n};\n\nFsLibrary.prototype.setHiddenCollections = function () {\n  const collection = this.getHiddenCollections();\n  this.hidden_collections = collection.map((val) =>\n    val.parentElement.cloneNode(true)\n  );\n\n//   collection.forEach((val) => (val.parentNode.outerHTML = \"\"));\n};\n"]}