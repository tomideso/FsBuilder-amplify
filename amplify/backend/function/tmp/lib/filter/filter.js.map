{"version":3,"sources":["filter/filter.ts"],"names":["FsLibrary","prototype","filter","filterArray","filterReset","animation","activeClass","cms_filter","Object","assign","filter_type","enable","test","String","effects","replace","indexOf","filterActive","filterQueue","triggerSelectors","get_cms_items","slice","call","document","querySelectorAll","cms_selector","Array","isArray","map","val","index","prevClicked","filterWrapper","selector","push","filter_group","assignChangeEventToButtons","resetButton","querySelector","addEventListener","initFilter","reset","filterType","filterByClass","filterRange","target","query","elem","j","tag_element","tagName","oldValue","event","filterText","selectedOptions","value","hold","wildcard","minInput","maxInput","passValue","addInputListener","type","checked","currentTarget","getAttribute","onclick","active","className","classList","remove","includes","add","update","nonWildcard","length","queue","filterHelper","Animate","methods","animate","findAndMatchFilterText","then","nextAnimation","shift","master_collection","disposableNote","queries","i","search_result","reduce","curr","join","result","children","item","re","RegExp","textContent","valid","isInRange","clonedItem","cloneNode","style","display","a","child","k","getBoundingClientRect","height","appendChild","searchRanges","targetText","ans","range","boundaries","split","parseFloat","num","otherElem","fxn","name","otherValue","filter_text"],"mappings":"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","file":"filter.js","sourcesContent":["import { FsLibrary } from \"../fsLibrary\";\nimport { debounce, escapeRegExp } from \"../utility\";\nimport Animate from \"../animate\";\nimport {\n  shouldFilter,\n  preventParentFormSubmission,\n  resetAllFilter,\n  removeMsg,\n  preventFormSubmission,\n} from \"./helper\";\n\nFsLibrary.prototype.filter = function ({\n  filterArray = [],\n  filterReset = \"\",\n  animation = this.animation,\n  activeClass = \"active\",\n}) {\n  let cms_filter = filterArray;\n  activeClass = activeClass || \"active\";\n\n  animation = { ...this.animation, ...animation };\n\n  let filter_type = typeof cms_filter == \"string\" ? \"exclusive\" : \"multi\";\n\n  if (animation) {\n    animation.enable = !/^false$/.test(String(animation.enable));\n    const effects = animation.effects.replace(\"fade\", \"\");\n    animation.effects = effects;\n\n    if (animation.effects.indexOf(\"translate\") < 0) {\n      animation.effects += \" translate(0px,0px)  \";\n    }\n    this.animation = animation;\n  }\n  animation = this.animation;\n\n  let filterActive = false;\n  let filterQueue = [];\n  let filter = {}; //to hold categories of filter selectors and their corresponding\n  let triggerSelectors = [];\n\n  //get all collections\n\n  const get_cms_items: any = () =>\n    [].slice.call(document.querySelectorAll(this.cms_selector));\n\n  if (Array.isArray(cms_filter)) {\n    cms_filter.map((val, index) => {\n      let prevClicked;\n      const { filterWrapper } = val;\n\n      const selector = `${filterWrapper} [filter-by]`;\n      triggerSelectors.push(selector);\n      const filter_group = [].slice.call(document.querySelectorAll(selector));\n      assignChangeEventToButtons({\n        index,\n        prevClicked,\n        filter_group,\n        ...val,\n      });\n    });\n  } else if (typeof cms_filter == \"string\") {\n    let prevClicked;\n    const selector = `${cms_filter} [filter-by]`;\n    triggerSelectors.push(selector);\n\n    const filter_group = [].slice.call(document.querySelectorAll(selector));\n    assignChangeEventToButtons({ index: 0, prevClicked, filter_group });\n  } else {\n    throw \"Incorrect type passed as cms_filter\";\n  }\n\n  if (filterReset) {\n    const resetButton = document.querySelector(filterReset);\n    resetButton.addEventListener(\"click\", () => {\n      initFilter({ reset: true });\n    });\n  }\n\n  function assignChangeEventToButtons({\n    index,\n    prevClicked,\n    filter_group,\n    filterType = filter_type,\n    filterByClass = null,\n    filterRange = false,\n  }) {\n    filter[index] = {\n      target: filterByClass,\n      query: [],\n      filterRange,\n    };\n\n    filter_group.map((elem, j) => {\n      const tag_element = elem && elem.tagName;\n      let oldValue = \"\";\n\n      if (tag_element == \"SELECT\") {\n        (<any>elem).addEventListener(\n          \"change\",\n          debounce((event) => {\n            const filterText = event.target.selectedOptions[0].value || \"\";\n\n            const hold = oldValue;\n            oldValue = filterText;\n\n            shouldFilter(filter, filterText, index) &&\n              initFilter({\n                filterType,\n                index,\n                filterText,\n                oldValue: hold,\n                wildcard: true,\n              });\n          }, 500)\n        );\n      } else if (tag_element == \"FORM\") {\n        preventFormSubmission(elem);\n        const minInput = elem.querySelector('input[name=\"min\"]');\n        const maxInput = elem.querySelector('input[name=\"max\"]');\n\n        const hold = oldValue;\n\n        const passValue = (filterText) => {\n          oldValue = filterText;\n\n          return initFilter({\n            index,\n            filterType,\n            wildcard: true,\n            oldValue: hold,\n            filterText,\n          });\n        };\n\n        addInputListener(minInput, maxInput, passValue);\n        addInputListener(maxInput, minInput, passValue);\n      } else if (tag_element == \"INPUT\") {\n        //handle checkbox and radio button\n\n        switch (elem.type) {\n          case \"text\":\n            preventParentFormSubmission(elem);\n\n            (<any>elem).addEventListener(\n              \"input\",\n              debounce((event) => {\n                const filterText = event.target.value;\n                const hold = oldValue;\n                oldValue = filterText;\n\n                shouldFilter(filter, filterText, index) &&\n                  initFilter({\n                    filterType,\n                    index,\n                    filterText,\n                    oldValue: hold,\n                    wildcard: true,\n                  });\n              }, 500)\n            );\n            break;\n          default:\n            (<any>elem).addEventListener(\"change\", (event) => {\n              const filterText = !event.target.checked\n                ? \"\"\n                : event.currentTarget.getAttribute(\"filter-by\") || \"\";\n              shouldFilter(filter, filterText, index) &&\n                initFilter({ filterType, index, filterText });\n            });\n            break;\n        }\n      } else {\n        (<any>elem).onclick = (event) => {\n          const active = event.currentTarget.className;\n\n          //only one element should have active class for or\n          if (\n            /^exclusive$/i.test(filter_type) ||\n            /^exclusive$/i.test(filterType)\n          ) {\n            if (prevClicked) prevClicked.classList.remove(activeClass);\n          }\n\n          prevClicked = event.currentTarget;\n\n          if (active.includes(activeClass)) {\n            prevClicked.classList.remove(activeClass);\n          } else {\n            prevClicked.classList.add(activeClass);\n          }\n\n          const filterText = prevClicked.getAttribute(\"filter-by\") || \"\";\n\n          //prevent further filter if filter is empty and reset button is clicked.\n\n          shouldFilter(filter, filterText, index) &&\n            initFilter({ filterType, index, filterText });\n        };\n      }\n    });\n  }\n\n  const initFilter = ({\n    filterType = \"exclusive\",\n    index = 0,\n    filterText = \"\",\n    oldValue = \"\",\n    wildcard = false,\n    reset = false,\n  }) => {\n    filterText = escapeRegExp(filterText.replace(/\\*/gi, \"\"));\n\n    const prevClicked = filter[index].query.includes(filterText);\n    const update = filter[index].query.filter((val) => val != filterText);\n    const nonWildcard = filter[index].query.filter((val) => val != oldValue);\n\n    if (reset) {\n      filter = resetAllFilter({ filter, activeClass, triggerSelectors });\n    }\n    //checks if it has previously been clicked\n    else if (prevClicked && !wildcard) {\n      filter[index].query = update;\n    } else {\n      filter[index].query = nonWildcard;\n      if (/^exclusive$/i.test(filter_type) || /^exclusive$/i.test(filterType)) {\n        filter[index].query = [filterText];\n      } else {\n        //it is definitely \"multi\"\n        filterText && filterText.length && filter[index].query.push(filterText);\n      }\n    }\n    if (animation.enable && animation.queue && filterActive) {\n      return filterQueue.push(() => filterHelper());\n    }\n\n    return filterHelper();\n  };\n\n  const filterHelper = () => {\n    filterActive = true;\n\n    //try to fix queue here\n    if (animation.enable) {\n      const target = document.querySelector(this.cms_selector);\n      return Animate.methods\n        .animate(\n          () => findAndMatchFilterText(filter, get_cms_items()),\n          target,\n          animation\n        )\n        .then(() => {\n          filterActive = false;\n\n          const nextAnimation = filterQueue.shift();\n          if (nextAnimation) {\n            nextAnimation.call(null);\n          }\n        });\n    }\n\n    findAndMatchFilterText(filter, get_cms_items());\n  };\n};\n\nconst findAndMatchFilterText = (filter, master_collection) => {\n  const disposableNote = removeMsg();\n  let queries = Object[\"values\"](filter);\n\n  master_collection.map((elem, i) => {\n    const search_result: any = queries.reduce(\n      (curr: any, { query, target, filterRange }) => {\n        //creating a regex to test against\n        const val = filterRange ? query : `(${query.join(\"|\")})`;\n\n        const result = [].slice.call(elem.children).map((item, j) => {\n          const re = new RegExp(val, \"gi\");\n\n          //checks if target is specified, otherwise use the textcontent from item\n          const textContent = (item.querySelector(target) || item).textContent;\n\n          const valid = filterRange\n            ? isInRange(val, textContent)\n            : re.test(textContent);\n\n          const clonedItem = item.cloneNode(true);\n\n          if (valid) {\n            clonedItem.style.display = \"block\";\n          } else {\n            clonedItem.style.display = \"none\";\n          }\n\n          // return clonedItem.outerHTML;\n          return clonedItem;\n        });\n\n        if (curr.length < 1) {\n          return result;\n        }\n\n        //intersections of the results\n        return [\n          ...curr.map((a, index) => {\n            if (a.style.display !== result[index].style.display) {\n              a.style.display = \"none\";\n            }\n            return a;\n          }),\n        ];\n      },\n      []\n    ); //.join(\"\").trim()\n\n    if (search_result.length > 1) {\n      [].slice.call(master_collection[i].children).map((child, k) => {\n        child.style.display = search_result[k].style.display;\n      });\n    }\n\n    const { height } = master_collection[i].getBoundingClientRect();\n\n    //empty search match\n    if (height < 1) {\n      master_collection[i].appendChild(disposableNote);\n    }\n  });\n};\n\nconst isInRange = (searchRanges, targetText) => {\n  const ans = searchRanges.filter((range) => {\n    const boundaries = range.split(\"-\").map(parseFloat);\n\n    let num =\n      targetText.replace(/[^0-9.]/g, \"\").replace(/(\\..*)\\./g, \"$1\") || 0;\n    num = parseFloat(num);\n\n    return (num - boundaries[0]) * (num - boundaries[1]) <= 0;\n  });\n\n  return searchRanges.length ? ans.length : true;\n};\n\nconst addInputListener = (elem, otherElem, fxn) => {\n  (<any>elem).addEventListener(\n    \"input\",\n    debounce((event) => {\n      event.target.value = event.target.value\n        .replace(/[^0-9.]/g, \"\")\n        .replace(/(\\..*)\\./g, \"$1\");\n\n      const name = event.target.name;\n\n      const val = event.target.value;\n\n      const otherValue = otherElem.value || 0;\n\n      const filter_text =\n        name == \"min\" ? `${val}-${otherValue}` : `${otherValue}-${val}`;\n\n      fxn(filter_text);\n    }, 500)\n  );\n};\n\ntype filterArray = {\n  filterWrapper: string;\n  filterType: string;\n  filterByClass: string;\n  range: boolean;\n};\n"]}