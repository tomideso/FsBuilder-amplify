{"version":3,"sources":["sort.ts"],"names":["FsLibrary","prototype","sort","sortTrigger","sortReverse","activeClass","animation","Object","assign","enable","test","String","effects","replace","indexOf","get_cms_items","slice","call","document","querySelectorAll","cms_selector","triggerElem","map","elem","triggerTag","tagName","addEventListener","event","sortTarget","target","selectedOptions","value","getAttribute","sortHelper","active","removeActiveClassFromTriggers","classList","toggle","currentTarget","previouslyClicked","contains","isReversed","forEach","outerHTML","remove","collator","Intl","Collator","numeric","sensitivity","initSort","sortMasterCollection","querySelector","Animate","methods","animate","master_collection","children","a","b","x","textContent","y","compare","sortedElem","insertBefore","firstChild","appendChild"],"mappings":"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","file":"sort.js","sourcesContent":["import { FsLibrary } from \"./fsLibrary\";\nimport Animate from \"./animate\";\nimport {debounce} from './utility'\n\n\nFsLibrary.prototype.sort=function({\n    sortTrigger,\n    sortReverse,\n    activeClass,\n    animation,\n  }) {\n    animation = { ...this.animation, ...animation };\n   \n    if (animation) {\n      animation.enable = !/^false$/.test(String(animation.enable));\n      const effects = animation.effects.replace(\"fade\", \"\");\n      animation.effects = effects;\n\n      if (animation.effects.indexOf(\"translate\") < 0) {\n        animation.effects += \" translate(0px,0px)  \";\n      }\n      this.animation = animation;\n    }\n\n    animation = this.animation;\n\n    const get_cms_items: any = () =>\n      [].slice.call(document.querySelectorAll(this.cms_selector));\n\n    const triggerElem = [].slice.call(document.querySelectorAll(sortTrigger));\n\n    triggerElem.map((elem) => {\n      const triggerTag = elem && elem.tagName;\n\n      if (triggerTag == \"SELECT\") {\n        (<any>elem).addEventListener(\n          \"change\",\n          debounce((event) => {\n            let sortTarget = event.target.selectedOptions[0].value;\n            sortTarget = sortTarget || event.getAttribute(\"sort-by\");\n\n            sortHelper({ sortTarget, sortReverse });\n          }, 200)\n        );\n      } else if (triggerTag == \"INPUT\") {\n        //handle checkbox and radio button\n\n        (<any>elem).addEventListener(\n          \"change\",\n          debounce((event) => {\n            const sortTarget = event.target.getAttribute(\"sort-by\") || \"\";\n            const active = String(activeClass).replace(\".\", \"\");\n\n            removeActiveClassFromTriggers(sortTarget, active);\n\n            event.target.classList.toggle(active);\n            sortHelper({ sortTarget, sortReverse });\n          }, 200)\n        );\n      } else {\n        (<any>elem).addEventListener(\"click\", (event) => {\n          const target = event.currentTarget;\n          const sortTarget = target.getAttribute(\"sort-by\") || \"\";\n          const active = String(activeClass).replace(\".\", \"\");\n\n          const previouslyClicked = target.classList.contains(active);\n\n          removeActiveClassFromTriggers(target, active);\n\n          elem.classList.toggle(active);\n\n          const isReversed = previouslyClicked ? !sortReverse : sortReverse;\n\n          sortHelper({ sortTarget, sortReverse: isReversed });\n        });\n      }\n    });\n\n    const removeActiveClassFromTriggers = (target, activeClass) => {\n      triggerElem.forEach((elem) => {\n        if (elem.outerHTML != target.outerHTML) {\n          elem.classList.remove(activeClass);\n        }\n      });\n    };\n\n    const collator = new Intl.Collator(\"en\", {\n      numeric: true,\n      sensitivity: \"base\",\n    });\n\n    const sortHelper = ({ sortTarget, sortReverse }) => {\n      const initSort = () => sortMasterCollection({ sortReverse, sortTarget });\n\n      if (animation.enable) {\n        const target = document.querySelector(this.cms_selector);\n        Animate.methods.animate(initSort, target, animation);\n      } else {\n        initSort();\n      }\n    };\n\n    const sortMasterCollection = ({ sortTarget, sortReverse }) => {\n      const master_collection = get_cms_items();\n\n      master_collection.map((elem) => {\n        return [].slice\n          .call(elem.children)\n          .sort((a, b) => {\n            const x = a.querySelector(sortTarget).textContent;\n            const y = b.querySelector(sortTarget).textContent;\n\n            return collator.compare(x, y);\n          })\n          .map((sortedElem) => {\n            if (sortReverse) {\n              elem.insertBefore(sortedElem, elem.firstChild);\n              return;\n            }\n            elem.appendChild(sortedElem);\n          });\n      });\n    };\n  }"]}