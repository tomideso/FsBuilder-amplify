{"version":3,"sources":["anchor.ts"],"names":["FsLibrary","prototype","anchor","anchorButton","buttonsTarget","activeClass","anchorId","cms","getMasterCollection","active","String","replace","targetHolder","document","querySelector","innerHTML","testimonials","slice","call","querySelectorAll","Webflow","window","done","map","elem","idx","arr","anchor_link","textContent","trim","sidebar_link","id","href","sidelink","outerHTML","appendChild","classList","add","Promise","resolve","all","then","elems","onScroll","Array","from","forEach","i","contains","remove"],"mappings":";;AAAA;;AACA;;AAEAA,qBAAUC,SAAV,CAAoBC,MAApB,GAA6B,gBAK5B;AAAA,MAJCC,YAID,QAJCA,YAID;AAAA,MAHCC,aAGD,QAHCA,aAGD;AAAA,MAFCC,WAED,QAFCA,WAED;AAAA,MADCC,QACD,QADCA,QACD;AACC,MAAMC,GAAG,GAAG,KAAKC,mBAAL,EAAZ;AACA,MAAMC,MAAM,GAAGC,MAAM,CAACL,WAAD,CAAN,CAAoBM,OAApB,CAA4B,GAA5B,EAAiC,EAAjC,CAAf;AAEA,MAAMC,YAAY,GAAGC,QAAQ,CAACC,aAAT,CAAuBV,aAAvB,CAArB;AACAQ,EAAAA,YAAY,CAACG,SAAb,GAAyB,EAAzB;AAEA,MAAMC,YAAY,GAAG,GAAGC,KAAH,CAASC,IAAT,CAAcX,GAAG,CAACY,gBAAJ,CAAqB,aAArB,CAAd,CAArB;AAEA,MAAMC,OAAO,GAASC,MAAO,CAACD,OAAR,IAAmB,EAAzC,CATD,CAWC;;AACA,MAAME,IAAI,GAAGN,YAAY,CAACO,GAAb,CAAiB,UAACC,IAAD,EAAOC,GAAP,EAAYC,GAAZ,EAAmB;AAC/C,QAAIC,WAAW,GAAGH,IAAI,CAACV,aAAL,CAAmBR,QAAnB,EAA6BsB,WAA7B,CAAyCC,IAAzC,EAAlB;AACAF,IAAAA,WAAW,GAAGA,WAAW,CAAChB,OAAZ,CAAoB,OAApB,EAA6B,GAA7B,CAAd;AACA,QAAMmB,YAAY,GAAGN,IAAI,CAACV,aAAL,CAAmBX,YAAnB,CAArB;AAEAqB,IAAAA,IAAI,CAACO,EAAL,GAAUJ,WAAV;AACAG,IAAAA,YAAY,CAACE,IAAb,GAAoB,MAAML,WAA1B;AAEA,QAAMM,QAAQ,GAAQ,oCAAsBH,YAAY,CAACI,SAAnC,CAAtB;AAEAtB,IAAAA,YAAY,CAACuB,WAAb,CAAyBF,QAAzB;;AAEA,QAAIR,GAAG,IAAI,CAAX,EAAc;AACZQ,MAAAA,QAAQ,CAACG,SAAT,CAAmBC,GAAnB,CAAuB5B,MAAvB;AACD;;AAED,WAAO6B,OAAO,CAACC,OAAR,CAAgBf,IAAhB,CAAP;AACD,GAjBY,CAAb;AAmBAc,EAAAA,OAAO,CAACE,GAAR,CAAYlB,IAAZ,EAAkBmB,IAAlB,CAAuB,UAACC,KAAD,EAAU;AAC/B,mCAAiB,QAAjB,EAA2B,uBAASC,QAAT,EAAmB,GAAnB,CAA3B;AACD,GAFD,EA/BD,CAkCC;;AAEA,MAAMA,QAAQ,GAAG,SAAXA,QAAW,GAAK;AACpBC,IAAAA,KAAK,CAACC,IAAN,CAAWhC,QAAQ,CAACM,gBAAT,CAA0Bf,aAAa,GAAG,IAA1C,CAAX,EAA4D0C,OAA5D,CACE,UAACtB,IAAD,EAAOuB,CAAP,EAAY;AACV,UAAIvB,IAAI,CAACY,SAAL,CAAeY,QAAf,CAAwB,YAAxB,CAAJ,EAA2C;AACzCxB,QAAAA,IAAI,CAACY,SAAL,CAAeC,GAAf,CAAmB5B,MAAnB;AACA;AACD;;AACDe,MAAAA,IAAI,CAACY,SAAL,CAAea,MAAf,CAAsBxC,MAAtB;AACD,KAPH;AASD,GAVD;AAWD,CApDD","file":"anchor.js","sourcesContent":["import { FsLibrary } from \"./fsLibrary\";\nimport { createElementFromHTML, registerListener, throttle } from \"./utility\";\n\nFsLibrary.prototype.anchor = function ({\n  anchorButton,\n  buttonsTarget,\n  activeClass,\n  anchorId,\n}) {\n  const cms = this.getMasterCollection();\n  const active = String(activeClass).replace(\".\", \"\");\n\n  const targetHolder = document.querySelector(buttonsTarget);\n  targetHolder.innerHTML = \"\";\n\n  const testimonials = [].slice.call(cms.querySelectorAll(\".w-dyn-item\"));\n\n  const Webflow = (<any>window).Webflow || [];\n\n  // Webflow.push(function () {\n  const done = testimonials.map((elem, idx, arr) => {\n    let anchor_link = elem.querySelector(anchorId).textContent.trim();\n    anchor_link = anchor_link.replace(/\\s+/gi, \"-\");\n    const sidebar_link = elem.querySelector(anchorButton);\n\n    elem.id = anchor_link;\n    sidebar_link.href = \"#\" + anchor_link;\n\n    const sidelink: any = createElementFromHTML(sidebar_link.outerHTML);\n\n    targetHolder.appendChild(sidelink);\n\n    if (idx == 0) {\n      sidelink.classList.add(active);\n    }\n\n    return Promise.resolve(elem);\n  });\n\n  Promise.all(done).then((elems) => {\n    registerListener(\"scroll\", throttle(onScroll, 100));\n  });\n  // });\n\n  const onScroll = () => {\n    Array.from(document.querySelectorAll(buttonsTarget + \">a\")).forEach(\n      (elem, i) => {\n        if (elem.classList.contains(\"w--current\")) {\n          elem.classList.add(active);\n          return;\n        }\n        elem.classList.remove(active);\n      }\n    );\n  };\n};\n"]}