{"version":3,"sources":["loadmore/index.ts","loadmore/index.js"],"names":["__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","apply","FsLibrary","prototype","loadmore","config","button","loadAll","resetIx","animation","infiniteScroll","infiniteScrollPercentage","paginate","enable","itemsPerPage","insertPagination","self","filterObj","hasLoadmore","indexSet","setNextButtonIndex","getCollections","getMasterCollection","setHiddenCollections","Object","assign","effects","replace","duration","easing","makeStyleSheet","transform","bgColorActive","borderColor","bgColor","textColor","textColorActive","nextButton","getLoadmoreHref","setAttribute","href","busy","onclick","evt","preventDefault","initFetch","style","display","isPaginated","initScroll","parent","children","len","length","pos","Math","round","bottom","document","addEventListener","event","loadmoreOn","lastFilter","recursive","getAttribute","getNextData","res","appendPaginatedData","paginateCollections","JSON","stringify","filterObject","reinitializeWebflow","nextcollection","hidden_collections","shift","appendToCms","firstElementChild","aHref","querySelector","setLoadmoreHref","index","outerHTML","slice","call","totalItems","pages","ceil","wf_fslib_pagination","createElement","id","classList","add","paginateItems","active","filterOn","findActivePageNumber","appendChild","childElems","filter","val","hasAttribute","forEach","element","shouldBeVisibleOnActivePage","last","parseInt","first","hasAttr","textContent"],"mappings":"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","file":"index.js","sourcesContent":["import { FsLibrary } from \"../fsLibrary\";\nimport \"./util\";\nimport { throttle, isInViewport, isOutOfViewport } from \"../utility\";\nimport { createPaginationStyle } from \"./pagination\";\nimport \"../paginate\";\n\nFsLibrary.prototype.loadmore = function (\n  config: LoadMore = {\n    button: \"a.w-pagination-next\",\n    loadAll: false,\n    resetIx: true,\n    animation: this.animation,\n    infiniteScroll: false,\n    infiniteScrollPercentage: 80,\n    paginate: {\n      enable: false,\n      itemsPerPage: 10,\n      insertPagination: \"\",\n    },\n  }\n): void {\n  const self = this;\n  let filterObj = {};\n\n  this.hasLoadmore = true;\n\n  if (!this.indexSet) {\n    this.setNextButtonIndex();\n  }\n\n  const getCollections = () => this.getMasterCollection();\n  this.setHiddenCollections();\n\n  config.animation = { ...this.animation, ...config.animation };\n\n  if (config.animation) {\n    const effects = config.animation.effects.replace(\"fade\", \"\");\n    let { duration, easing } = config.animation;\n    duration = duration ? duration / 1000 : 1;\n    easing = easing || \"linear\";\n    this.makeStyleSheet({ duration, easing, transform: effects });\n  } else {\n    this.makeStyleSheet({});\n  }\n\n  const {\n    button,\n    resetIx = false,\n    loadAll = false,\n    infiniteScroll = false,\n    infiniteScrollPercentage = 80,\n    paginate = {\n      enable: false,\n      itemsPerPage: 10,\n      insertPagination: \"\",\n      bgColorActive: \"#9AB87A\",\n      borderColor: \"#3D315B\",\n      bgColor: \"#444B6E\",\n      textColor: \"#000\",\n      textColorActive: \"#000\",\n    },\n  } = config;\n\n  const {\n    textColor,\n    bgColorActive,\n    borderColor,\n    bgColor,\n    itemsPerPage,\n    textColorActive,\n  } = paginate;\n\n  const nextButton = this.getLoadmoreHref(button);\n  nextButton.setAttribute(\"data-href\", (<any>nextButton).href);\n  // nextButton.removeAttribute(\"href\");\n\n  let busy = false;\n\n  (<any>nextButton).onclick = (evt) => {\n    evt.preventDefault();\n\n    initFetch();\n  };\n\n  if (loadAll && paginate.enable) {\n    nextButton.style.display = \"none\";\n    this.isPaginated = true;\n    this.itemsPerPage = itemsPerPage;\n    createPaginationStyle({\n      bgColorActive,\n      textColor,\n      borderColor,\n      bgColor,\n      textColorActive,\n    });\n  }\n\n  const initScroll = throttle((evt) => {\n    const parent = getCollections();\n    const children = parent.children;\n    const len = children.length;\n\n    const pos = Math.round((infiniteScrollPercentage * len) / 100);\n\n    if (isInViewport(children[pos]) || !isOutOfViewport(parent).bottom) {\n      initFetch();\n    }\n  }, 700);\n\n  if (infiniteScroll) {\n    document.addEventListener(\"scroll\", initScroll);\n  }\n\n  document.addEventListener(\"DOMContentLoaded\", function (event) {\n    if (loadAll) {\n      initFetch(true, () => {\n        this.loadmoreOn = false;\n\n        filterObj = self.lastFilter ? self.lastFilter() : filterObj;\n      });\n    }\n  });\n\n  const initFetch = (recursive = false, done?) => {\n    if (busy) return false;\n    this.loadmoreOn = true;\n\n    const href = nextButton.getAttribute(\"data-href\");\n\n    busy = true;\n\n    if (href) {\n      return this.getNextData(href).then((res) => {\n        //enable button\n        this.appendPaginatedData(<any>res);\n\n        if (paginate.enable) {\n          const { itemsPerPage, insertPagination } = paginate;\n          paginateCollections(itemsPerPage, insertPagination, self).then(\n            async (res) => {\n              if (\n                JSON.stringify(filterObj) != JSON.stringify(self.filterObject)\n              ) {\n                filterObj = self.lastFilter\n                  ? await self.lastFilter()\n                  : filterObj;\n              }\n            }\n          );\n        }\n\n        busy = false;\n\n        if (resetIx) {\n          this.reinitializeWebflow();\n        }\n\n        if (recursive) {\n          initFetch(true, done);\n        }\n      });\n    }\n\n    const nextcollection = this.hidden_collections.shift();\n    if (nextcollection) {\n      this.appendToCms(nextcollection.firstElementChild.children).then(\n        (res) => {\n          if (paginate.enable) {\n            const { itemsPerPage, insertPagination } = paginate;\n            paginateCollections(itemsPerPage, insertPagination, self).then(\n              (res) => {\n                if (\n                  JSON.stringify(filterObj) != JSON.stringify(self.filterObject)\n                ) {\n                  filterObj = self.lastFilter ? self.lastFilter() : filterObj;\n                }\n              }\n            );\n          }\n\n          if (resetIx) {\n            this.reinitializeWebflow();\n          }\n        }\n      );\n      const aHref = nextcollection.querySelector(\".w-pagination-next\");\n      aHref && this.setLoadmoreHref(aHref.href);\n      this.index++;\n      busy = false;\n\n      if (!this.hidden_collections.length && !aHref) {\n        (<any>this.getLoadmoreHref()).outerHTML = \"\";\n        done(true);\n        this.loadmoreOn = false;\n        return;\n      }\n\n      if (recursive) {\n        initFetch(true, done);\n      }\n    }\n    {\n      resetIx && this.reinitializeWebflow();\n      this.loadmoreOn = false;\n      done(true);\n    }\n  };\n\n  const paginateCollections = (itemsPerPage = 10, insertPagination, self) => {\n    const parent = getCollections();\n    const children = [].slice.call(parent.children);\n    const totalItems = children.length;\n    const pages = Math.ceil(totalItems / itemsPerPage);\n\n    const wf_fslib_pagination = document.createElement(\"div\");\n    wf_fslib_pagination.id = \"wf-fslib-pagination\";\n    wf_fslib_pagination.classList.add(\"fs-pagination\");\n\n    paginateItems({\n      children,\n      itemsPerPage,\n      active: 1,\n      filterOn: self.filterOn,\n    });\n\n    wf_fslib_pagination.addEventListener(\"click\", function () {\n      const parent = getCollections();\n      const children = [].slice.call(parent.children);\n\n      const active = findActivePageNumber();\n\n      paginateItems({\n        children,\n        itemsPerPage,\n        active,\n        filterOn: self.filterOn,\n      });\n    });\n\n    document.querySelector(insertPagination).appendChild(wf_fslib_pagination);\n    (<any>FsLibrary).paginate(pages, 1);\n    return Promise.resolve();\n  };\n};\n\nfunction paginateItems({ children, itemsPerPage, active, filterOn }) {\n  let childElems = [].slice.call(children);\n\n  if (filterOn) {\n    childElems\n      .filter((val) => val.hasAttribute(\"wf-fslib-paginated-hide\"))\n      .forEach((element, index) => {\n        shouldBeVisibleOnActivePage({\n          index,\n          element,\n          active,\n          itemsPerPage,\n          filterOn,\n        });\n      });\n    return;\n  }\n\n  childElems.forEach((element, index) => {\n    shouldBeVisibleOnActivePage({\n      index,\n      element,\n      active,\n      itemsPerPage,\n      filterOn,\n    });\n  });\n}\n\nexport const shouldBeVisibleOnActivePage = ({\n  index,\n  element,\n  active,\n  itemsPerPage,\n  filterOn = false,\n}) => {\n  const last = itemsPerPage * parseInt(active);\n  const first = last - itemsPerPage;\n\n  const hasAttr = element.hasAttribute(\"wf-fslib-paginated-hide\");\n\n  if (index >= first && index < last) {\n    if (!filterOn) {\n      element.style.display = \"\";\n    } else if (hasAttr) {\n      element.style.display = \"\";\n      element.setAttribute(\"wf-fslib-paginated-hide\", 2);\n    }\n    return true;\n  }\n\n  if (!filterOn) {\n    element.style.display = \"none\";\n  } else if (hasAttr) {\n    element.setAttribute(\"wf-fslib-paginated-hide\", 1);\n  }\n  return false;\n};\n\nexport const findActivePageNumber = () => {\n  const active = document.querySelector(\n    `.fs-pagination ul li.fs-pagination-active a`\n  );\n  return active ? active.textContent : 1;\n};\n\ninterface LoadMore {\n  button: string;\n  loadAll?: boolean;\n  resetIx?: boolean;\n  animation?: Animatn;\n  infiniteScroll?: boolean;\n  infiniteScrollPercentage?: number;\n  paginate?: Paginate;\n}\n\ninterface Paginate {\n  enable: boolean;\n  itemsPerPage: number;\n  insertPagination: string;\n  bgColorActive?: string;\n  borderColor?: string;\n  textColor?: string;\n  bgColor?: string;\n  textColorActive?: string;\n}\n\ninterface Animatn {\n  enable?: boolean;\n  easing?: string;\n  duration?: number;\n  effects?: string;\n  queue?: boolean;\n}\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nimport { FsLibrary } from \"../fsLibrary\";\nimport \"./util\";\nimport { throttle, isInViewport, isOutOfViewport } from \"../utility\";\nimport { createPaginationStyle } from \"./pagination\";\nimport \"../paginate\";\nFsLibrary.prototype.loadmore = function (config = {\n    button: \"a.w-pagination-next\",\n    loadAll: false,\n    resetIx: true,\n    animation: this.animation,\n    infiniteScroll: false,\n    infiniteScrollPercentage: 80,\n    paginate: {\n        enable: false,\n        itemsPerPage: 10,\n        insertPagination: \"\",\n    },\n}) {\n    const self = this;\n    let filterObj = {};\n    this.hasLoadmore = true;\n    if (!this.indexSet) {\n        this.setNextButtonIndex();\n    }\n    const getCollections = () => this.getMasterCollection();\n    this.setHiddenCollections();\n    config.animation = Object.assign({}, this.animation, config.animation);\n    if (config.animation) {\n        const effects = config.animation.effects.replace(\"fade\", \"\");\n        let { duration, easing } = config.animation;\n        duration = duration ? duration / 1000 : 1;\n        easing = easing || \"linear\";\n        this.makeStyleSheet({ duration, easing, transform: effects });\n    }\n    else {\n        this.makeStyleSheet({});\n    }\n    const { button, resetIx = false, loadAll = false, infiniteScroll = false, infiniteScrollPercentage = 80, paginate = {\n        enable: false,\n        itemsPerPage: 10,\n        insertPagination: \"\",\n        bgColorActive: \"#9AB87A\",\n        borderColor: \"#3D315B\",\n        bgColor: \"#444B6E\",\n        textColor: \"#000\",\n        textColorActive: \"#000\",\n    }, } = config;\n    const { textColor, bgColorActive, borderColor, bgColor, itemsPerPage, textColorActive, } = paginate;\n    const nextButton = this.getLoadmoreHref(button);\n    nextButton.setAttribute(\"data-href\", nextButton.href);\n    // nextButton.removeAttribute(\"href\");\n    let busy = false;\n    nextButton.onclick = (evt) => {\n        evt.preventDefault();\n        initFetch();\n    };\n    if (loadAll && paginate.enable) {\n        nextButton.style.display = \"none\";\n        this.isPaginated = true;\n        this.itemsPerPage = itemsPerPage;\n        createPaginationStyle({\n            bgColorActive,\n            textColor,\n            borderColor,\n            bgColor,\n            textColorActive,\n        });\n    }\n    const initScroll = throttle((evt) => {\n        const parent = getCollections();\n        const children = parent.children;\n        const len = children.length;\n        const pos = Math.round((infiniteScrollPercentage * len) / 100);\n        if (isInViewport(children[pos]) || !isOutOfViewport(parent).bottom) {\n            initFetch();\n        }\n    }, 700);\n    if (infiniteScroll) {\n        document.addEventListener(\"scroll\", initScroll);\n    }\n    document.addEventListener(\"DOMContentLoaded\", function (event) {\n        if (loadAll) {\n            initFetch(true, () => {\n                this.loadmoreOn = false;\n                filterObj = self.lastFilter ? self.lastFilter() : filterObj;\n            });\n        }\n    });\n    const initFetch = (recursive = false, done) => {\n        if (busy)\n            return false;\n        this.loadmoreOn = true;\n        const href = nextButton.getAttribute(\"data-href\");\n        busy = true;\n        if (href) {\n            return this.getNextData(href).then((res) => {\n                //enable button\n                this.appendPaginatedData(res);\n                if (paginate.enable) {\n                    const { itemsPerPage, insertPagination } = paginate;\n                    paginateCollections(itemsPerPage, insertPagination, self).then((res) => __awaiter(this, void 0, void 0, function* () {\n                        if (JSON.stringify(filterObj) != JSON.stringify(self.filterObject)) {\n                            filterObj = self.lastFilter\n                                ? yield self.lastFilter()\n                                : filterObj;\n                        }\n                    }));\n                }\n                busy = false;\n                if (resetIx) {\n                    this.reinitializeWebflow();\n                }\n                if (recursive) {\n                    initFetch(true, done);\n                }\n            });\n        }\n        const nextcollection = this.hidden_collections.shift();\n        if (nextcollection) {\n            this.appendToCms(nextcollection.firstElementChild.children).then((res) => {\n                if (paginate.enable) {\n                    const { itemsPerPage, insertPagination } = paginate;\n                    paginateCollections(itemsPerPage, insertPagination, self).then((res) => {\n                        if (JSON.stringify(filterObj) != JSON.stringify(self.filterObject)) {\n                            filterObj = self.lastFilter ? self.lastFilter() : filterObj;\n                        }\n                    });\n                }\n                if (resetIx) {\n                    this.reinitializeWebflow();\n                }\n            });\n            const aHref = nextcollection.querySelector(\".w-pagination-next\");\n            aHref && this.setLoadmoreHref(aHref.href);\n            this.index++;\n            busy = false;\n            if (!this.hidden_collections.length && !aHref) {\n                this.getLoadmoreHref().outerHTML = \"\";\n                done(true);\n                this.loadmoreOn = false;\n                return;\n            }\n            if (recursive) {\n                initFetch(true, done);\n            }\n        }\n        {\n            resetIx && this.reinitializeWebflow();\n            this.loadmoreOn = false;\n            done(true);\n        }\n    };\n    const paginateCollections = (itemsPerPage = 10, insertPagination, self) => {\n        const parent = getCollections();\n        const children = [].slice.call(parent.children);\n        const totalItems = children.length;\n        const pages = Math.ceil(totalItems / itemsPerPage);\n        const wf_fslib_pagination = document.createElement(\"div\");\n        wf_fslib_pagination.id = \"wf-fslib-pagination\";\n        wf_fslib_pagination.classList.add(\"fs-pagination\");\n        paginateItems({\n            children,\n            itemsPerPage,\n            active: 1,\n            filterOn: self.filterOn,\n        });\n        wf_fslib_pagination.addEventListener(\"click\", function () {\n            const parent = getCollections();\n            const children = [].slice.call(parent.children);\n            const active = findActivePageNumber();\n            paginateItems({\n                children,\n                itemsPerPage,\n                active,\n                filterOn: self.filterOn,\n            });\n        });\n        document.querySelector(insertPagination).appendChild(wf_fslib_pagination);\n        FsLibrary.paginate(pages, 1);\n        return Promise.resolve();\n    };\n};\nfunction paginateItems({ children, itemsPerPage, active, filterOn }) {\n    let childElems = [].slice.call(children);\n    if (filterOn) {\n        childElems\n            .filter((val) => val.hasAttribute(\"wf-fslib-paginated-hide\"))\n            .forEach((element, index) => {\n            shouldBeVisibleOnActivePage({\n                index,\n                element,\n                active,\n                itemsPerPage,\n                filterOn,\n            });\n        });\n        return;\n    }\n    childElems.forEach((element, index) => {\n        shouldBeVisibleOnActivePage({\n            index,\n            element,\n            active,\n            itemsPerPage,\n            filterOn,\n        });\n    });\n}\nexport const shouldBeVisibleOnActivePage = ({ index, element, active, itemsPerPage, filterOn = false, }) => {\n    const last = itemsPerPage * parseInt(active);\n    const first = last - itemsPerPage;\n    const hasAttr = element.hasAttribute(\"wf-fslib-paginated-hide\");\n    if (index >= first && index < last) {\n        if (!filterOn) {\n            element.style.display = \"\";\n        }\n        else if (hasAttr) {\n            element.style.display = \"\";\n            element.setAttribute(\"wf-fslib-paginated-hide\", 2);\n        }\n        return true;\n    }\n    if (!filterOn) {\n        element.style.display = \"none\";\n    }\n    else if (hasAttr) {\n        element.setAttribute(\"wf-fslib-paginated-hide\", 1);\n    }\n    return false;\n};\nexport const findActivePageNumber = () => {\n    const active = document.querySelector(`.fs-pagination ul li.fs-pagination-active a`);\n    return active ? active.textContent : 1;\n};\n"]}